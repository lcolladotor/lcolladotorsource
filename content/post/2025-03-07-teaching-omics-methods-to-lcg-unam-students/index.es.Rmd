---
title: Clase sobre m√©todos √≥micos para estudiantes de la LCG UNAM
author: L. Collado-Torres
date: '2025-03-07'
slug: teaching-omics-methods-to-lcg-unam-students
categories:
  - UNAM
tags:
  - LCG
  - Genomics
  - Teaching
subtitle: ''
summary: ''
authors: []
lastmod: '2025-03-07T08:56:37-06:00'
featured: no
image:
  caption: ''
  focal_point: ''
  preview_only: no
projects: []
---

{{% callout note %}}
Notas de una clase de un curso introductorio a las t√©cnicas de investigaci√≥n √≥micas en la LCG-UNAM. Es decir, donde estudi√© mi licenciatura. ¬°Gracias por la invitaci√≥n!
{{% /callout %}}

[Valentina Arias Ojeda](https://bsky.app/profile/vaalarias.bsky.social) ayudante en la materia "T√©cnicas de Investigaci√≥n √ìmicas", impartida por la [Dra. Constance Auvynet](https://www.ibt.unam.mx/perfil/1596/dra-constance-genevieve-jeanne-henriette-auvynet) en la [LCG-UNAM](https://www.lcg.unam.mx/). Me invitaron a dar una clase sobre m√©todos √≥micos, en particular sobre secuenciaci√≥n de c√©lulas √∫nicas y sobre secuenciaci√≥n a resoluci√≥n espacial. Valentina me present√≥ y luego mencion√© un poco de [mi historia de ense√±anza](https://lcolladotor.github.io/es/#teaching), comenzando desde mi primera experiencia de ense√±anza donde hice [un sitio web disponible en ingl√©s y espa√±ol](https://lcolladotor.github.io/courses/Courses/B/).

Decid√≠ ense√±ar la clase de hoy como una sesi√≥n colectiva de ["gu√≠a para ciencia de datos"](https://lcolladotor.github.io/bioc_team_ds/data-science-guidance-sessions.html) (DSgs en ingl√©s). Sin embargo, a diferencia de una DSgs regular, primero necesit√°bamos hacer una lista de preguntas o conceptos que quer√≠an aprender m√°s. Aqu√≠ us√© una t√©cnica que aprend√≠ como asistente para la serie de cursos 140.620 sobre _M√©todos Estad√≠sticos en Salud P√∫blica_ en JHU. Es decir, escribir en el pizarr√≥n las preguntas, luego tratar de agruparlas en diferentes categor√≠as. Nuestra lista completa de preguntas fue:

1. ARN-seq
    * ¬øCu√°l es la diferencia entre microarreglos y RNA-seq?
    * ¬øQu√© es ARN-seq?
    * ¬øC√≥mo tratamos con ARN ribosomal en ARN-seq?
    * ¬øC√≥mo tratamos con ruido en ARN-seq?
      * ¬øC√≥mo definimos ruido?
    * ¬øC√≥mo lidea ARN-seq con estructuras secundarias de ARN?
2. ARN-seq de c√©lulas √∫nicas
    * ¬øQu√© es ARN-seq de c√©lulas √∫nicas?
    * ¬øPara qu√© es √∫til el ARN-seq de c√©lulas √∫nicas?
    * ¬øCu√°les son las principales tecnolog√≠as de secuenciaci√≥n?
    * ¬øQu√© es ATAC-seq?
    * ¬øQu√© es insitu seq?
3. Transcript√≥mica resuelta espacialmente
    * ¬øQu√© es la transcript√≥mica resuelta espacialmente?
    * ¬øCu√°l es la diferencia entre la transcript√≥mica resuelta espacialmente y el ARN-seq de c√©lulas √∫nicas?
    * ¬øC√≥mo podemos integrar ARN-seq y transcript√≥mica resuelta espacialmente?
    * ¬øCu√°les son las f√≠sicas detr√°s de la transcript√≥mica resuelta espacialmente?
4. An√°lisis de datos
    * ¬øPor qu√© usamos R para el an√°lisis de datos √≥micos?
      * ¬øC√≥mo analizamos datos de ARN-seq?
      * ¬øC√≥mo analizamos datos de ARN-seq de c√©lulas √∫nicas?
      * ¬øC√≥mo analizamos datos de transcript√≥mica resuelta espacialmente?
    * ¬øCu√°nto poder computacional necesitamos para el an√°lisis de datos √≥micos espaciales?
    * ¬øC√≥mo integramos datos de ARN-seq y transcript√≥mica resuelta espacialmente?
    
![](https://lcolladotor.github.io/2025/03/07/2025-03-07-teaching-omics-methods-to-lcg-unam-students/images/IMG_0190.jpg)
    
## ARN-seq

<script defer class="speakerdeck-embed" data-slide="2" data-id="2c3377401c934bb9abd859b644bb9455" data-ratio="1.7772511848341233" src="//speakerdeck.com/assets/embed.js"></script>

Us√© esta diapositiva con una imagen de [Gandal](https://x.com/mikejg84) et al DOI [10.1016/j.biopsych.2020.06.005](https://doi.org/10.1016/j.biopsych.2020.06.005) que muestra muchos tipos de mol√©culas de ARN. Muchos est√°n principalmente interesados en el ARNm: [ARN mensajero](https://es.wikipedia.org/wiki/ARN_mensajero). Aunque otras mol√©culas de ARN pueden ser de inter√©s, como los [microARNs](https://es.wikipedia.org/wiki/MicroARN).

Sobre microarreglos, expliqu√© c√≥mo son ensayos basados en sondas donde una compa√±√≠a dise√±a las sondas, las imprimen en una placa de vidrio, y c√≥mo los datos se generan a trav√©s de im√°genes de alta resoluci√≥n (fotos) de la placa de vidrio. Para hacer esto, tienes que conocer la anotaci√≥n de genes (d√≥nde se encuentran los genes en el genoma) para dise√±ar las sondas. Los microarreglos son m√°s baratos que el ARN-seq y se han utilizado mucho para el genotipado de ADN, donde estamos interesados en un conjunto de aproximadamente 2.5 millones de ubicaciones en el genoma que var√≠an com√∫nmente entre individuos.

ARN-seq realmente se populariz√≥ o bueno, fue posible, con la llegada de la secuenciaci√≥n de nueva generaci√≥n. La idea es que puedes secuenciar las mol√©culas de ARN en una muestra y luego alinear las secuencias al genoma para saber de d√≥nde provienen. Esto es m√°s caro que los microarreglos pero tiene la ventaja de que no necesitas conocer la anotaci√≥n de genes de antemano. Esto se debe a que puedes alinear las secuencias al genoma y luego contar cu√°ntas secuencias se alinean a cada gen. Tambi√©n puedes estudiar isoformas (transcritos), en lugar de genes. Una b√∫squeda r√°pida en Google me llev√≥ [aqu√≠](https://biology.stackexchange.com/questions/37002/please-explain-what-a-gene-isoform-is-in-lay-terms) ya que quer√≠a mostrarles una ilustraci√≥n de un gen con m√∫ltiples transcritos, algunos de ellos con diferencias muy peque√±as entre ellos. Tambi√©n vimos el [historial de lanzamientos de Gencode](https://www.gencodegenes.org/human/releases.html) para resaltar que la anotaci√≥n de genes no es est√°tica y se actualiza con frecuencia.

Para una breve introducci√≥n a la secuenciaci√≥n de nueva generaci√≥n o secuenciaci√≥n de alto rendimiento (estos eran sin√≥nimos en 2006 a 2011 o as√≠), volv√≠ a un curso que ense√±√© a estudiantes de doctorado de la UNAM poco despu√©s de terminar mi licenciatura. De https://lcolladotor.github.io/courses/PDCB-HTS.html, vimos la [presentaci√≥n de diapositivas para "2. Entendiendo la tecnolog√≠a"](https://lcolladotor.github.io/courses/Courses/PDCB-HTS/lectures/02_HTStech01/02_Understanding_the_Tech_01.pptx). Particularmente las diapositivas 39 a 42 donde expliqu√© brevemente la secuenciaci√≥n de lecturas cortas de Illumina.

En relaci√≥n con los ARN ribosomales, expliqu√© los dos protocolos de ARN-seq m√°s comunes: poliA+ y depleci√≥n de ribosomas (RiboZeroGold). Us√© un [preprint que escribimos en 2024 donde la Figura 1B](https://doi.org/10.1101/2024.02.09.579665) muestra los dos tipos de bibliotecas de ARN-seq, pero tambi√©n los diferentes protocolos de extracci√≥n de ARN (a menudo algo que la gente ignora).

<a href="https://doi.org/10.1101/2024.02.09.579665"><img src="https://www.biorxiv.org/content/biorxiv/early/2024/04/07/2024.02.09.579665/F1.large.jpg?width=800&height=600&carousel=1" width="600px"></a>

La Figura 1D destaca cu√°n diferentes son los datos usando componentes principales (PC1 separa el tipo de biblioteca, PC2 separa las extracciones de ARN), y la Figura 1E muestra dentro de una extracci√≥n de ARN dada, c√≥mo se cuantifican diferencialmente los genes por los dos tipos de bibliotecas.

Para el ruido en ARN-seq, vimos mi art√≠culo de doctorado [`derfinder`](https://doi.org/10.1093/biostatistics/kxt053). La Figura 1 es en realidad un recordatorio de c√≥mo los transcritos pueden tener diferencias muy peque√±as entre ellos. La Figura 2 tiene curvas de cobertura para datos de ARN-seq. Usamos `derfinder` cuando estudiamos cambios de expresi√≥n en el cerebro humano a trav√©s de grupos de edad incluyendo muestras prenatales DOI [10.1038/nn.3898](https://doi.org/10.1038/nn.3898). A trav√©s de ese trabajo concluimos que el transcriptoma del cerebro humano estaba incompleto. Mencion√© tambi√©n c√≥mo los datos de poliA y RiboZeroGold tendr√°n perfiles de cobertura diferentes (RiboZeroGold mostrar√° cobertura para intrones ya que algunos pre-ARNm se secuenciar√°n). Tambi√©n describ√≠ la m√©trica `totalAssignedGene` que [`SPEAQeasy`](https://research.libd.org/SPEAQeasy/outputs.html#coldata-of-rse-objects) genera: la fracci√≥n de lecturas asignadas a genes del n√∫mero total de lecturas que se alinearon al genoma. Hemos usado `totalAssignedGene` para identificar muestras de baja calidad en algunos estudios.

Tambi√©n mencion√© brevemente que una ventaja de ARN-seq es la posibilidad de ensamblar transcritos usando herramientas como [`StringTie`](https://ccb.jhu.edu/software/stringtie/) desarrollado por algunos de mis colaboradores. Corrieron `StringTie` en ~10,000 muestras de ARN-seq de GTEx para construir [CHESS](https://ccb.jhu.edu/chess/). Eventualmente de ~26 millones de transcritos filtraron la lista y encontraron ~160,000 transcritos DOI [10.1186/s13059-023-03088-4](https://doi.org/10.1186/s13059-023-03088-4). Hay muchos desaf√≠os sobre c√≥mo decides qu√© es un transcripci√≥n _real_ versus ruido. ¬øConf√≠as m√°s en un transcrito con 100 lecturas pero solo en una muestra o un transcrito con 5 lecturas por muestra que est√° presente en 10% de tus muestras?

Sobre las estructuras secundarias en ARN, expliqu√© c√≥mo los protocolos de ARN-seq involucran un paso donde el ARN se corta en fragmentos de aproximadamente 300 a 500 pares de bases. Esa es una forma de lidiar con las estructuras secundarias del ARN. Aunque no recuerdo si hay otros pasos que ayudan a evitar problemas con el plegado del ARN. Y podr√≠a ser algo que olvidamos: algunos ARN que son m√°s propensos a plegarse pueden no estar tan bien representados en los datos de ARN-seq.


## scRNA-seq

Para scRNA-seq, us√© partes de este video explicativo de 10x Genomics. Lo paus√© algunas veces para resaltar los GEMs, la fluidica para meter c√©lulas en gotas, y c√≥mo cada gota tiene un c√≥digo de barras celular (una secuencia de ADN √∫nica), y hay alrededor de 750,000 de ellos en un experimento dado.

<iframe width="560" height="315" src="https://www.youtube.com/embed/4NAS1qTJmYA?si=pf-iNv02m9T0BLn0" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>

Al final generas ADN que puedes secuenciar con secuenciadores de Illumina. De hecho, muchos otros protocolos son todos sobre generar ADN para las mol√©culas de inter√©s, luego secuenciar esas mol√©culas de ADN con Illumina. Por ejemplo, ChIP-seq, ATAC-seq, etc√©tera.

## Transcript√≥mica resuelta espacialmente

Para explicar la transcript√≥mica resuelta espacialmente, mostr√© a los estudiantes [mi publicaci√≥n de blog](https://lcolladotor.github.io/2024/05/23/humanpilot-first-spatially-resolved-transcriptomics-study-using-visium/) (con videos en ingl√©s y espa√±ol) explicando el primer art√≠culo de 10x Genomics Visium que escribimos DOI [10.1038/s41593-020-00787-0](https://doi.org/10.1038/s41593-020-00787-0). Destaqu√© c√≥mo Visium usa "c√≥digos de barras espaciales", similares a los c√≥digos de barras de scRNA-seq que vimos anteriormente. Estas secuencias de ADN etiquetan los casi 5,000 puntos presentes en una diapositiva de Visium. Aqu√≠ hay un breve video de introducci√≥n de 10x Genomics a Visium.

<iframe width="560" height="315" src="https://www.youtube.com/embed/VwNk4d-0RJc?si=poZAaCY3VmjHQIZA" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>

Para el tejido que estabamos estudiando (DLPFC de cerebro humano), encontramos que cada punto de Visium conten√≠a en promedio 3 c√©lulas. Con la omica espacial encuentras c√≥mo las c√©lulas est√°n agrupadas espacialmente, lo que puede ser informativo a diferencia de lo que obtenemos con scRNA-seq (perfiles de expresi√≥n de c√©lulas individuales sin informaci√≥n espacial) o bulk RNA-seq (como licuar un mont√≥n de c√©lulas y obtener el perfil de expresi√≥n general). La deconvoluci√≥n de puntos, que probamos un poco en DOI [10.1126/science.adh1938](https://doi.org/10.1126/science.adh1938), y la deconvoluci√≥n de bulk RNA-seq que tambi√©n probamos en DOI [10.1101/2024.02.09.579665](https://doi.org/10.1101/2024.02.09.579665), son algunos m√©todos computacionales que permiten integrar m√∫ltiples sabores de RNA-seq juntos. Dai et al tambi√©n escribieron un art√≠culo de referencia muy bueno para los m√©todos de deconvoluci√≥n de bulk RNA-seq de segunda generaci√≥n utilizando datos de scRNA-seq como referencia: DOI [10.1126/sciadv.adh2588](https://doi.org/10.1126/sciadv.adh2588).

Tambi√©n resalt√© c√≥mo con bulk RNA-seq algunos conjuntos de datos de LIBD tienen 80 millones de lecturas pareadas de 100 pares de bases cada una (como alrededor de $1,000 USD por muestra). En √∫ltima instancia, la longitud de lectura (en pares de bases) multiplicada por el n√∫mero de lecturas determina cu√°nto dinero vas a gastar en secuenciaci√≥n. 10x Genomics recomienda 50,000 lecturas por c√©lula para scRNA-seq o por punto para Visium. Un √°rea de captura de Visium tiene 5,000 puntos, es decir, son 250 millones de lecturas por √°rea de captura de Visium. Gastas alrededor de 2,000 a 2,500 USD por √°rea de captura de Visium solo para la secuenciaci√≥n de Illumina sin incluir otros reactivos de 10x Genomics. Adem√°s, las opciones que tienes por c√©lula o por punto est√°n limitadas ya que pasaste de 80 millones de lecturas a 50 mil (¬°una reducci√≥n de 1,600 veces!). Entonces, scRNA-seq y Visium son mucho m√°s dispersos que el ARN-seq a granel. Algunos protocolos de scRNA-seq tambi√©n est√°n sesgados hacia el 3', lo que significa que solo secuencias el extremo 3' de las mol√©culas de ARN. Algunos han desarrollado formas de cuantificar los transcritos a pesar de estos sesgos, pero sigue siendo un √°rea de investigaci√≥n activa. Sin embargo, los costos de generaci√≥n de datos para cada ensayo a veces determinan qu√© ensayos se pueden usar. Sin embargo, si otros han compartido datos relevantes, entonces puedes reutilizar esos datos y no tienes que generarlos todos t√∫ mismo.

En t√©rminos de los mejores m√©todos para la secuenciaci√≥n de ARN y los ensayos asociados, mencion√© que una forma de verificar esto es mirando la valoraci√≥n de estas empresas y sus precios de las acciones. Estas empresas adquieren con frecuencia empresas m√°s peque√±as, se demandan entre s√≠, etc. Algunos de ellas se han visto afectados por recientes guerras comerciales, por ejemplo [_China proh√≠be la importaci√≥n de secuenciadores de genes de Illumina justo despu√©s de la acci√≥n arancelaria de Trump_](https://www.reuters.com/business/healthcare-pharmaceuticals/china-bans-imports-illuminas-gene-sequencers-2025-03-04/). Esto se hizo parcialmente porque dos empresas chinas de gen√≥mica fueron acusadas por los EE. UU. por motivos de seguridad nacional. En general, Illumina y 10x Genomics est√°n entre los jugadores m√°s grandes en el campo. Hay otras empresas grandes y muchas peque√±as (20 o m√°s empleados), algunas de las cuales buscan ser adquiridas por las grandes.

## An√°lisis de datos

Ver√© a estos estudiantes de segundo semestre dentro de un a√±o cuando tomen la clase de cuarto semestre de introducci√≥n a an√°lisis de datos de ARN-seq con R y [Bioconductor](https://bioconductor.org/) que [he ense√±ado los √∫ltimos cinco a√±os](https://lcolladotor.github.io/rnaseq_LCG-UNAM_2025/). Como un adelanto r√°pido, mencion√© que Bioconductor es un gran repositorio de software de c√≥digo abierto para el an√°lisis de datos biol√≥gicos de alto rendimiento: microarreglos hace 23 a√±os y hoy en d√≠a scRNA-seq y omicas espaciales. Tambi√©n es obligatorio escribir gu√≠as de usuario (documentos de vi√±etas) sobre todo el software de Bioconductor. Esto facilita mucho el aprendizaje de c√≥mo usar el software y es un factor distintivo que separa a Bioconductor de otros repositorios de software.

Les mostr√© unas diapositivas de la presentaci√≥n reciente de mi equipo de TL DR (muy largo, no lo le√≠).

<blockquote class="bluesky-embed" data-bluesky-uri="at://did:plc:h7p2smbyfobkpcs7dbgvhmeh/app.bsky.feed.post/3lhz4wurwpc2n" data-bluesky-cid="bafyreiarms7jqajwka2ebetelb5pz2f5waen6rxqsdndezhoqezxvrciwq"><p lang="en">Check our recent video &quot;[2025-01-29] R/Bioconductor-powered Team Data Science: TLDR version 2025&quot;
youtu.be/alL-g2roXxM

We go over what analyses our @lieberinstitute.bsky.social has expertise on üíª

Slides orchestrated by @lahuuki.bsky.social at speakerdeck.com/lahuuki/2025...

üë• go.bsky.app/53gy4UP<br><br><a href="https://bsky.app/profile/did:plc:h7p2smbyfobkpcs7dbgvhmeh/post/3lhz4wurwpc2n?ref_src=embed">[image or embed]</a></p>&mdash; üá≤üáΩ Leonardo Collado-Torres (<a href="https://bsky.app/profile/did:plc:h7p2smbyfobkpcs7dbgvhmeh?ref_src=embed">@lcolladotor.bsky.social</a>) <a href="https://bsky.app/profile/did:plc:h7p2smbyfobkpcs7dbgvhmeh/post/3lhz4wurwpc2n?ref_src=embed">February 12, 2025 at 3:35 PM</a></blockquote><script async src="https://embed.bsky.app/static/embed.js" charset="utf-8"></script>

<iframe width="560" height="315" src="https://www.youtube.com/embed/alL-g2roXxM?si=Q1bemiqdhljcfXAG" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>

Primero les mostr√© c√≥mo Visium HD es una nueva tecnolog√≠a de 10x Genomics que es basada en sondas. As√≠ que piensa en ello como un microarreglo moderno que est√° resuelto espacialmente. Tambi√©n es lo suficientemente potente como para generar datos de resoluci√≥n subcelular: empezando desde cuadrados de 2 micrones.

<script defer class="speakerdeck-embed" data-slide="12" data-id="21f0f91a68b14806a2f489a371f29e94" data-ratio="1.7772511848341233" src="//speakerdeck.com/assets/embed.js"></script>

Analizar estos datos puede ser exigente computacionalmente en t√©rminos de requerir GPUs y/o nodos de c√≥mputo de alta memoria.

<script defer class="speakerdeck-embed" data-slide="18" data-id="21f0f91a68b14806a2f489a371f29e94" data-ratio="1.7772511848341233" src="//speakerdeck.com/assets/embed.js"></script>


Al final, puede haber una necesidad de procesar uniformemente datos de ARN-seq disponibles p√∫blicamente para democratizar el acceso a estos datos de modo que los investigadores sin acceso a entornos inform√°ticos de alto rendimiento. Trabaj√© en esto a trav√©s de los proyectos `recount2` y `recount3` DOI [10.1186/s13059-021-02533-6](https://doi.org/10.1186/s13059-021-02533-6). Les ense√±ar√© m√°s sobre esto el pr√≥ximo a√±o.

## Temas adicionales

Termin√© resaltando recursos de la [Comunidad de Desarrolladores de Software de Bioinform√°tica (CDSB)](https://comunidadbioinfo.github.io/) y el [Club RStats LIBD](https://research.libd.org/rstatsclub/). Ah√≠ los estudiantes pueden encontrar videos de talleres completos de una semana como el [curso de an√°lisis de scRNA-seq de 2021](https://www.youtube.com/playlist?list=PLwa0ZAE6DJg6j0QEgtgzQwi5xsz6po22E) y muchos otros videos del [calendario del Club RStats LIBD](https://docs.google.com/spreadsheets/d/1is8dZSd0FZ9Qi1Zvq1uRhm-P1McnJRd_zxdAfCRoMfA/edit?usp=sharing).

Tambi√©n resalt√© c√≥mo uno tiene que pasar horas de trabajo tratando de aprender nuevos m√©todos en lugar de confiar en hacerlo en su tiempo libre. Finalmente, resalt√© c√≥mo me gusta aprender en p√∫blico. C√≥mo compartir lo que sabes puede ser √∫til no solo para otros, sino tambi√©n para ti mismo.

![](https://lcolladotor.github.io/2025/03/07/2025-03-07-teaching-omics-methods-to-lcg-unam-students/images/IMG_0191.jpg)

Siempre da gusto volver a la LCG-UNAM, mi alma mater de licenciatura. Tambi√©n disfruto interactuar con los estudiantes actuales. Aqu√≠ estoy con Valentina y [Bernardo](https://bsky.app/profile/bernardochombo.bsky.social), ambos trabajan como ayudantes y est√°n terminando su tercer a√±o. A continuaci√≥n empezar√°n su √∫ltimo a√±o que es un a√±o de investigaci√≥n. Ya nos dar√°n noticias sobre lo que eligen trabajar y me dar√° gusto ver c√≥mo florecen sus carreras.


{{% callout note %}}
[Ac√° est√°n todas las ligas que les mostr√© hoy en clase](https://www.one-tab.com/page/qrgMQDQbQ9-BGSsmPIyvrA).
{{% /callout %}}
